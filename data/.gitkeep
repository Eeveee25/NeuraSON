import streamlit as st
import pandas as pd
import joblib
import matplotlib.pyplot as plt

# Load model
model = joblib.load("models/fault_predictor.pkl")

st.title("NeuraSON â€“ Network Health Optimizer")

# Upload file
uploaded_file = st.file_uploader("Upload a KPI CSV file", type="csv")

if uploaded_file is not None:
    df = pd.read_csv(uploaded_file)

    st.subheader("Raw KPI Data")
    st.dataframe(df)

    # Prepare data
    features = ['RSRP', 'RSRQ', 'SINR', 'throughput_Mbps']
    df['predicted_fault'] = model.predict(df[features])

    st.subheader("Fault Prediction")
    st.write(df[['timestamp', 'cell_id', 'predicted_fault']])

    st.subheader("KPI Trend Plot")
    df[['RSRP', 'SINR']].plot(figsize=(10, 5))
    st.pyplot(plt)
else:
    st.info("Please upload a CSV file to start analysis.")
